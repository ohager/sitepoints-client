var _spc=_spc||{};_spc.Config=function(n){function e(n,e){return t&&t[n]?t[n]:e}var t=n;this.serverHost=e("serverHost","http://localhost:3000"),this.cacheSize=e("cacheSize",10),this.cacheTimeout=e("cacheTimeout",10),this.mouseTracking=e("mouseTracking",!0),this.trackingInterval=e("trackingInterval",1e3),this.apikey=e("apikey",null),this.onflush=e("onflush",null),this.verbose=e("verbose",!1)};var _spc=_spc||{};_spc.PointTracker=function(){var n,e={},t=window.onmousemove,i=window.onclick,o=function(n,t){e.x=n.screenX,e.y=n.screenY,e.url=window.location.href,e.created=Date.now(),t&&t(n)},c=function(){return{x:e.x,y:e.y,url:e.url,created:e.created}};this.startClickTracking=function(n){window.onclick=function(e){o(e,i),n(c())}},this.stopClickTracking=function(){window.onclick=i},this.startIntervalTracking=function(i,s){window.onmousemove=function(n){o(n,t)},clearInterval(n),setInterval(function(){e&&i(c())},s)},this.stopIntervalTracking=function(){clearInterval(n),window.onmousemove=t}};var _spc=_spc||{};_spc.main=function(n){function e(n){o.push(n)}var t=new _spc.Config(n),i=new _spc.PointTracker,o=new _spc.Storage(t),c=window.onunload;i.startClickTracking(e),t.mouseTracking&&i.startIntervalTracking(e,t.trackingInterval),window.onunload=function(n){o.blockingFlush(),c&&c(n)}};var _spc=_spc||{};_spc.Storage=function(n){function e(n){function e(){var n=new Date;return n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()+"'"+n.getMilliseconds()}o&&console.log("["+e()+"] Sitepoints - "+n)}var t,i=this,o=n.verbose,c=n.serverHost,s=n.cacheSize,r=1e3*n.cacheTimeout,a=[],u=function(){a=[],clearTimeout(t)};this.push=function(n){e(" Stored P("+n.x+", "+n.y+") @ "+n.created+")"),a.push(n),r>0&&(clearTimeout(t),t=setTimeout(function(){i.flush()},r)),a.length>=s&&(clearTimeout(t),i.flush())},this.data=function(){return a.slice()},this.flush=function(t){var i=c+"/restapi/sitepoint?k="+n.apikey;if(e("Flushing "+a.length+" elements to "+i+"..."),0===a.length)return void e("Flush skipped");var o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&(e("Flushed successfully"),n.onflush&&n.onflush(o))},o.open("POST",i,void 0===t||t===!0),o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(a)),u()},this.blockingFlush=this.flush.bind(null,!1)};